import { expect, test } from "bun:test";
import { AESL } from "../src/aes.js";

test("AESL test vector", () => {
  // Test vector from specification appendix
  const input = new Uint8Array([
    0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
  ]);

  const expected = new Uint8Array([
    0x63, 0x79, 0xe6, 0xd9, 0xf4, 0x67, 0xfb, 0x76, 0xad, 0x06, 0x3c, 0xf4, 0xd2, 0xeb, 0x8a, 0xa3,
  ]);

  const result = AESL(input);

  expect(result).toEqual(expected);
});
